<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For You ‚ù§Ô∏è</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        /* --- GLOBAL STYLES --- */
        @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Dancing+Script:wght@700&display=swap');

        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            background-color: #ffdde1;
            background-image: radial-gradient(#ffeff2 2px, transparent 2px), radial-gradient(#ffeff2 2px, transparent 2px);
            background-size: 30px 30px;
            background-position: 0 0, 15px 15px;
            font-family: 'Comic Neue', 'Comic Sans MS', cursive, sans-serif;
            overflow: hidden;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'  width='40' height='48' viewport='0 0 100 100' style='fill:black;font-size:24px;'><text y='50%'>‚ù§Ô∏è</text></svg>") 16 0, auto;
            transition: background-color 1s ease;
        }

        /* --- FLASHLIGHT OVERLAY --- */
        #flashlight {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            background: radial-gradient(circle 450px at 50% 50%, transparent 0%, rgba(0,0,0,0.98) 20%);
            opacity: 0;
            transition: opacity 2.0s ease;
        }

        /* --- FLASHLIGHT TOGGLE BUTTON --- */
        .toggle-flash-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid white;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            z-index: 1001; /* Above flashlight overlay */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        .toggle-flash-btn:hover {
            transform: scale(1.1);
            background: white;
        }

        /* --- HEARTBEAT ANIMATION (Page 3) --- */
        body.heartbeat-bg {
            animation: heartbeatAnim 1.5s infinite alternate;
        }

        @keyframes heartbeatAnim {
            0% { background-color: #ffdde1; }
            100% { background-color: #ffb7b2; }
        }

        .container {
            position: relative;
            width: 100%;
            max-width: 600px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-sizing: border-box;
            z-index: 10;
        }

        .hidden {
            display: none !important;
        }

        /* --- ANIMATIONS --- */
        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        
        .fade-in-text {
            animation: fadeIn 2s ease-in-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        h1, h2, p {
            color: #d63384;
            text-shadow: 2px 2px 0px #fff;
        }

        .main-img {
            max-width: 300px;
            max-height: 300px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* --- PAPER STYLE --- */
        .paper-content {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 15px;
            max-width: 90%;
            min-height: 300px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            font-size: 1.1rem;
            line-height: 1.6;
            color: #444;
            text-align: left;
            position: relative;
            cursor: pointer;
            overflow-y: auto;
        }
        
        .typing-cursor::after {
            content: '|';
            animation: blink 1s step-start infinite;
        }

        @keyframes blink { 50% { opacity: 0; } }

        /* --- POLAROID MEMORIES --- */
        .memory-photo {
            position: absolute;
            width: 150px;
            height: auto;
            border: 8px solid white;
            border-bottom: 25px solid white; 
            border-radius: 2px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1; 
            opacity: 0.9;
            animation: floatUpSlow 15s linear infinite;
            bottom: -300px;
            transition: transform 0.3s, z-index 0.3s;
        }

        .memory-photo:hover {
            animation-play-state: paused;
            z-index: 100;
            transform: scale(1.1) rotate(0deg) !important;
            cursor: grab;
        }

        @keyframes floatUpSlow {
            0% { bottom: -300px; transform: translateX(0) rotate(0deg); opacity: 0; }
            5% { opacity: 1; }
            95% { opacity: 1; }
            100% { bottom: 110vh; transform: translateX(20px) rotate(360deg); opacity: 0; }
        }

        /* --- BUTTONS --- */
        .btn-group {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
            min-height: 60px;
        }

        button {
            padding: 15px 30px;
            font-size: 1.2rem;
            font-family: inherit;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-yes {
            background-color: #ff4d6d;
            color: white;
            font-weight: bold;
        }
        
        .btn-no {
            background-color: #fff;
            color: #ff4d6d;
            border: 2px solid #ff4d6d;
        }

        button:hover {
            transform: scale(1.05);
        }

        /* --- ENVELOPE --- */
        .envelope-wrapper {
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .envelope-wrapper:hover {
            transform: scale(1.02);
        }

        .envelope {
            position: relative;
            width: 300px;
            height: 200px;
            background: #ff4d6d;
            border-radius: 0 0 10px 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            z-index: 2;
        }

        .envelope::before { content: ''; position: absolute; top: 0; left: 0; width: 0; height: 0; border-style: solid; border-width: 100px 150px 100px 0; border-color: transparent transparent transparent #ff758f; z-index: 3; }
        .envelope::after { content: ''; position: absolute; top: 0; right: 0; width: 0; height: 0; border-style: solid; border-width: 100px 0 100px 150px; border-color: transparent #ff758f transparent transparent; z-index: 3; }

        .flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 0;
            border-style: solid;
            border-width: 100px 150px 0 150px;
            border-color: #c9184a transparent transparent transparent;
            z-index: 5;
            transform-origin: top;
            transition: transform 0.6s ease 0.5s, z-index 0.2s 0.5s;
        }

        .envelope-text {
            position: absolute;
            top: 65%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            text-align: center;
            line-height: 1.2;
            z-index: 4;
            pointer-events: none;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
            transition: opacity 0.5s ease;
        }

        .letter {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 260px;
            height: 180px;
            background: #fff;
            padding: 20px;
            box-sizing: border-box;
            border-radius: 10px;
            transition: bottom 0.6s ease 1s;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-size: 1.1rem;
            color: #333;
            box-shadow: 0 -5px 10px rgba(0,0,0,0.1);
        }

        .letter p { opacity: 0; transition: opacity 0.5s ease 1.2s; }
        .envelope-wrapper.open .flap { transform: rotateX(180deg); z-index: 0; }
        .envelope-wrapper.open .letter { bottom: 150px; z-index: 6; }
        .envelope-wrapper.open .letter p { opacity: 1; }
        .envelope-wrapper.open .envelope-text { opacity: 0; } 

        /* --- STICKERS --- */
        .sticker {
            position: absolute;
            width: 80px;
            height: 80px;
            z-index: -1;
            opacity: 0.6;
            animation: floatSlow 3s infinite ease-in-out;
        }

        .floating-item {
            position: absolute;
            bottom: -50px;
            font-size: 30px;
            animation: floatUp linear forwards;
            pointer-events: none;
            z-index: 1000;
        }

        /* --- SPARKLE CURSOR TRAIL --- */
        .sparkle {
            position: absolute;
            width: 6px;
            height: 6px;
            background-color: #ff4d6d;
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            animation: fadeOut 1s linear forwards;
            box-shadow: 0 0 5px #fff, 0 0 10px #ff4d6d;
        }

        @keyframes fadeOut {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }
        
        @keyframes floatSlow {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .shy-text {
            font-size: 1.4rem;
            color: #d63384;
            opacity: 0.8;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div id="flashlight"></div>

    <audio id="bg-music" loop>
        <source src="INSERT_YOUR_LINK_HERE" type="audio/mpeg">
        <source src="https://www.bensound.com/bensound-music/bensound-love.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>

    <div class="container">

        <div id="page1" class="page-section fade-in">
            <div class="envelope-wrapper" onclick="openEnvelope()">
                <div class="envelope">
                    <div class="flap"></div>
                    <div class="envelope-text">To Neha<br><span style="font-size: 0.8em">from Ady</span></div>
                    <div class="letter">
                        <p> i hope you like this ü§≠<br><br>
                        <span style="font-size: 0.8em; color: #999;">(Click me)</span></p>
                    </div>
                </div>
            </div>
        </div>

        <div id="pageMessage" class="page-section hidden fade-in" onclick="handleMessageClick()">
            <div class="paper-content" id="typewriter-container">
                </div>
        </div>

        <div id="page2" class="page-section hidden" onclick="handlePage2Click()">
            
            <button id="flash-toggle" class="toggle-flash-btn hidden" onclick="toggleFlashlight(event)">üî¶</button>

            <h2 style="color: white; text-shadow: 0 0 10px #ff4d6d;">I'm so grateful to have you</h2>
            <p id="page2-hint" class="hidden" style="color: #ddd;">(Click to continue)</p>
        </div>
        
        <div id="pagePreQuestion1" class="page-section hidden fade-in" onclick="nextPage('PreQuestion2')">
             <h2 class="shy-text">so, um, alsooo.</h2>
             <p style="font-size: 0.8em; color: #999; margin-top: 20px;">(Click)</p>
        </div>
        
        <div id="pagePreQuestion2" class="page-section hidden fade-in" onclick="nextPage(3)">
             <h2 class="shy-text">i wanted to ask</h2>
             <p style="font-size: 0.8em; color: #999; margin-top: 20px;">(Click)</p>
        </div>

        <div id="page3" class="page-section hidden fade-in">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExdjN0dDk4bTh6bGIzeG4zMGM1bTkyaXFnNXd4ZWgzN2xodmhucDN3MCZlcD12MV9naWZzX3NlYXJjaCZjdD1n/Zl7u48zLVFgLpRwq6f/giphy.gif" alt="Please cat">
            <h1>Will you be my valentine? üåπ</h1>
            <div class="btn-group">
                <button class="btn-yes" onclick="handleYes()">Yes</button>
                <button class="btn-no" onclick="handleNo()">No</button>
            </div>
        </div>

        <div id="page4" class="page-section hidden fade-in">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExeHI4MDIybXJlYTh1MXd5N3gyNzNhNG41aWwxZG85bG01MmRtZ2wxYyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/5Ac3lAE4Ydz6E/giphy.gif" alt="Crying cat">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbmxnNG84Y3lmenAyaGNtazJkNjNvOTJsNzFnbWtvOGxvbHQ0ZWo5OSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/aWMJvA76tNnBR9gkpT/giphy.gif" class="sticker" style="top: 10%; left: 10%;">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbmxnNG84Y3lmenAyaGNtazJkNjNvOTJsNzFnbWtvOGxvbHQ0ZWo5OSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/ruyS8Zw9sBqE5UjOnY/giphy.gif" class="sticker" style="top: 20%; right: 10%;">
            <img src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExbmxnNG84Y3lmenAyaGNtazJkNjNvOTJsNzFnbWtvOGxvbHQ0ZWo5OSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/mi4ec226vjAkehSLk0/giphy.gif" class="sticker" style="bottom: 10%; left: 20%;">
            <h2>Pleaseeeeeü•π</h2>
            <div class="btn-group">
                <button class="btn-yes" onclick="handleYes()">Yes</button>
                <button class="btn-no" onclick="handleNo()">No</button>
            </div>
        </div>

        <div id="page5" class="page-section hidden fade-in">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExZjd4b2E1bThrMWY0OWQ5c3NyOWR5cXlxbnV5bGJsZ2VyeHIzZWZ1ZyZlcD12MV9naWZzX3NlYXJjaCZjdD1n/N92tr5rzjZx7wnRKiy/giphy.gif" alt="Very sad cat">
            <h2>Pleaseeeeeeeeü•π</h2>
            <div class="btn-group">
                <button class="btn-yes" onclick="handleYes()">Yes</button>
                <button class="btn-no" onclick="handleNo()">No</button>
            </div>
        </div>

        <div id="page6" class="page-section hidden fade-in" onclick="nextPage(7)">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExamU1ZHh1aGhybGswMDMwamFqOGpxeTM1dzIxbnVxeWoyenZqZWE2NSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/YhYgIyRd7dETRsOtK6/giphy.gif" alt="Pissed off cat">
            <h2>hell naw, are you ragebaiting?</h2>
            <p style="font-size: 0.8rem; color: #888;">(Click to continue...)</p>
        </div>

        <div id="page7" class="page-section hidden fade-in">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExNjk5eHgzcmduaXduZnY4ZWM2dDJoaTExNTgzbGt6MXAwYnZwbGM2NiZlcD12MV9naWZzX3NlYXJjaCZjdD1n/YLPOIP1jPu1N87yemm/giphy.gif" alt="Evil cat">
            <h2>i was delusional enough back then, and still am</h2>
	    <h1>will you be my valentine?üåπ</h1>

            <div class="btn-group">
                <button class="btn-yes" onclick="handleYes()">YES</button>
            </div>
        </div>

        <div id="pageSurprise" class="page-section hidden fade-in" onclick="handleSurpriseClick()">
            <img class="main-img" src="https://media.giphy.com/media/v1.Y2lkPTc5MGI3NjExYzNoZ2o0ZHpzdDh1cnVkM3VrZHh4eHNvbGQ5emIyZmJwOHJwNGo2dSZlcD12MV9naWZzX3NlYXJjaCZjdD1n/Cdkk6wFFqisTe/giphy.gif" alt="Surprised cat">
            <h2>Damn.</h2>
            <p id="surprise-hint" class="hidden">(Click to continue)</p>
        </div>

        <div id="page8" class="page-section hidden fade-in">
            <h1>Yayyyy! I love you sooo much! ‚ù§Ô∏è</h1>
        </div>

    </div>

    <script>
        // --- CONFIGURATION ---
        const yourPhotos = [
            "https://i.ibb.co/3ySdCgpw/IMG-20251213-WA0285.jpg", 
            "https://i.ibb.co/6cxmz76X/IMG-20251205-181300.jpg", 
            "https://i.ibb.co/jk7BLRP0/IMG-20251111-WA0099.jpg", 
            "https://i.ibb.co/Psnd1Hfj/IMG-20251111-WA0100.jpg",
            "https://i.ibb.co/BHnQWhNx/IMG-20251205-WA0044.jpg",
            "https://i.ibb.co/tTy6WDB2/IMG-20251213-WA0284.jpg",
            "https://i.ibb.co/Vc9KMRsX/IMG-20251021-WA0019.jpg",
            "https://i.ibb.co/MD7pQ2B2/IMG-20251213-WA0204.jpg"
        ];

        const fullMessage = `hiii, my pretty gf. its been another month!! still cant believe that i am dating YOU, the mysterious and nonchalant baddie. hehe. i am happy i was delusional enough, lmfaooo üò≠.

and also, for you to push me to get me out of my sneaky, indirect language (which were pretty directü´† apparently) and finally say it out loud.

and ofc, that one spotify jam!! all that made it possible for me to finally see your chalant, yapper side and im so soo glad. you make everything so much better<3.

its like the girl with the monochromatic presence i wrote about, is sending rays of colors and happiness at me. i hope i do the same for you.

i miss you a lot. i love you‚ù§Ô∏è`;

        // ---------------------

        let noCount = 0;
        let yesScale = 1.0;
        let musicStarted = false;
        let memoryInterval;
        let page2Clickable = false; 
        let surpriseClickable = false; 
        
        // Variables for Typewriter Control
        let isTyping = false;
        let typingTimeout;

        const music = document.getElementById('bg-music');
        music.volume = 0.5;

        // --- SPARKLE CURSOR ---
        document.addEventListener('mousemove', function(e) { createSparkle(e.pageX, e.pageY); });
        document.addEventListener('touchmove', function(e) { createSparkle(e.touches[0].pageX, e.touches[0].pageY); });

        function createSparkle(x, y) {
            const sparkle = document.createElement('div');
            sparkle.classList.add('sparkle');
            sparkle.style.left = x + 'px';
            sparkle.style.top = y + 'px';
            document.body.appendChild(sparkle);
            setTimeout(() => sparkle.remove(), 1000);
        }

        // --- FLASHLIGHT LOGIC ---
        const flashlight = document.getElementById('flashlight');
        let flashlightEnabled = false;
        
        document.addEventListener('mousemove', moveFlashlight);
        document.addEventListener('touchmove', moveFlashlight);

        function moveFlashlight(e) {
            // Only update if flashlight layer is visible
            if (flashlight.style.opacity > 0) {
                let x, y;
                if (e.type === 'touchmove') {
                    x = e.touches[0].clientX;
                    y = e.touches[0].clientY;
                } else {
                    x = e.clientX;
                    y = e.clientY;
                }
                flashlight.style.background = `radial-gradient(circle 450px at ${x}px ${y}px, transparent 0%, rgba(0,0,0,0.98) 20%)`;
            }
        }

        // Toggle Flashlight Manually
        function toggleFlashlight(event) {
            event.stopPropagation(); // Prevent page click
            if (flashlight.style.opacity == 1) {
                flashlight.style.opacity = 0; // Turn off
            } else {
                flashlight.style.opacity = 1; // Turn on
            }
        }

        function startMusic() {
            if (!musicStarted) {
                music.play().catch(error => console.log("Audio play failed"));
                musicStarted = true;
            }
        }

        function openEnvelope() {
            startMusic();
            document.querySelector('.envelope-wrapper').classList.add('open');
            setTimeout(() => {
                document.querySelector('.letter').style.cursor = "pointer";
                document.querySelector('.letter').onclick = () => nextPage('Message');
            }, 1500);
        }

        // Handle clicks on Message Page (Skip typing or go next)
        function handleMessageClick() {
            if (isTyping) {
                // If currently typing, stop and show full text
                clearTimeout(typingTimeout);
                const container = document.getElementById('typewriter-container');
                container.innerHTML = fullMessage.replace(/\n/g, '<br>') + '<p style="text-align: center; font-size: 0.8em; color: #999; margin-top: 20px;">(Click to continue)</p>';
                isTyping = false; // Flag that typing is done
            } else {
                // If not typing (finished or skipped), go to next page
                nextPage(2);
            }
        }

        function handlePage2Click() {
            if (page2Clickable) {
                nextPage('PreQuestion1');
            }
        }

        function handleSurpriseClick() {
            if (surpriseClickable) {
                finalizeSuccess();
            }
        }

        function nextPage(pageNumber) {
            
            // Cleanup
            document.querySelectorAll('.main-img').forEach(img => img.classList.remove('shake'));
            document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
            
            const nextPageEl = document.getElementById(`page${pageNumber}`);
            nextPageEl.classList.remove('hidden');
            
            // ONLY FADE IN IF NOT PAGE 2
            if (pageNumber !== 2) {
                nextPageEl.classList.remove('fade-in');
                void nextPageEl.offsetWidth; 
                nextPageEl.classList.add('fade-in');
            } else {
                // For Page 2, ensure no fade-in class
                nextPageEl.classList.remove('fade-in');
            }

            // --- TYPEWRITER (Message) ---
            if (pageNumber === 'Message') {
                const container = document.getElementById('typewriter-container');
                container.innerHTML = '<span class="typing-cursor"></span>';
                isTyping = true; // Set flag
                typeWriterEffect(container, fullMessage);
            }

            // --- PAGE 2 (Flashlight + Photos) ---
            if (pageNumber === 2) {
                // TURN ON FLASHLIGHT INSTANTLY
                flashlight.style.opacity = 1;
                flashlightEnabled = true;

                page2Clickable = false;
                const hintText = document.getElementById('page2-hint');
                const toggleBtn = document.getElementById('flash-toggle');
                hintText.classList.add('hidden'); 
                toggleBtn.classList.add('hidden');

                spawnImmediatePhotos(); 
                startMemoryInterval();  

                // 4 Seconds: Fade out darkness
                setTimeout(() => {
                    flashlight.style.opacity = 0;
                    // Show toggle button
                    toggleBtn.classList.remove('hidden');
                }, 4000);

                // 6 Seconds: Unlock click
                setTimeout(() => {
                    page2Clickable = true;
                    hintText.classList.remove('hidden');
                    hintText.classList.add('fade-in-text'); 
                }, 6000);

            } else {
                flashlight.style.opacity = 0;
                stopMemories();
            }
            
            // --- PAGE 3 (Heartbeat) ---
            if (pageNumber === 3) {
                document.body.classList.add('heartbeat-bg');
            } else {
                document.body.classList.remove('heartbeat-bg');
            }

            // --- SURPRISE ---
            if (pageNumber === 'Surprise') {
                surpriseClickable = false;
                const surpriseHint = document.getElementById('surprise-hint');
                surpriseHint.classList.add('hidden');

                setTimeout(() => {
                    surpriseClickable = true;
                    surpriseHint.classList.remove('hidden');
                    surpriseHint.classList.add('fade-in-text');
                }, 3000);
            }
        }

        // --- TYPEWRITER FUNCTION ---
        function typeWriterEffect(element, text) {
            let i = 0;
            element.classList.add('typing-cursor');
            
            function type() {
                if (i < text.length) {
                    if (text.charAt(i) === '\n') {
                        element.innerHTML = element.innerHTML.replace('<span class="typing-cursor"></span>', '') + '<br>' + '<span class="typing-cursor"></span>';
                    } else {
                        element.innerHTML = element.innerHTML.replace('<span class="typing-cursor"></span>', '') + text.charAt(i) + '<span class="typing-cursor"></span>';
                    }
                    i++;
                    // Save timeout ID so we can cancel it on click
                    typingTimeout = setTimeout(type, Math.random() * 40 + 30);
                } else {
                    element.innerHTML = element.innerHTML.replace('<span class="typing-cursor"></span>', '');
                    element.innerHTML += '<p style="text-align: center; font-size: 0.8em; color: #999; margin-top: 20px;">(Click to continue)</p>';
                    isTyping = false; // Finished automatically
                }
            }
            type();
        }

        function spawnImmediatePhotos() {
            for (let i = 0; i < 7; i++) {
                createPhoto(true); 
            }
        }

        function startMemoryInterval() {
            memoryInterval = setInterval(() => {
                createPhoto(false);
            }, 1000); 
        }

        function createPhoto(isImmediate) {
            const img = document.createElement('img');
            img.src = yourPhotos[Math.floor(Math.random() * yourPhotos.length)];
            img.classList.add('memory-photo');
            img.style.left = Math.random() * 90 + 'vw';
            const randomRot = Math.random() * 40 - 20;
            img.style.transform = `rotate(${randomRot}deg)`;

            if (isImmediate) {
                img.style.animationDelay = `-${Math.random() * 10 + 2}s`;
            }

            document.body.appendChild(img);
            setTimeout(() => { img.remove(); }, 15000);
        }

        function stopMemories() {
            clearInterval(memoryInterval);
            document.querySelectorAll('.memory-photo').forEach(el => el.remove());
        }

        function handleNo() {
            noCount++;
            yesScale += 0.3;
            
            const currentImage = document.querySelector(`#page${noCount === 1 ? 4 : (noCount === 2 ? 5 : 6)} .main-img`);
            if (currentImage) {
                currentImage.classList.add('shake');
                setTimeout(() => currentImage.classList.remove('shake'), 500);
            }

            if (noCount === 1) {
                nextPage(4);
                updateYesButtons();
            } else if (noCount === 2) {
                nextPage(5);
                updateYesButtons();
            } else if (noCount === 3) {
                nextPage(6);
            }
        }

        function updateYesButtons() {
            const yesButtons = document.querySelectorAll('.btn-yes');
            yesButtons.forEach(btn => btn.style.transform = `scale(${yesScale})`);
        }

        function handleYes() {
            startMusic();
            if (noCount === 0) {
                nextPage('Surprise');
            } else {
                finalizeSuccess();
            }
        }

        function finalizeSuccess() {
            document.querySelectorAll('.page-section').forEach(el => el.classList.add('hidden'));
            
            const successPage = document.getElementById('page8');
            successPage.classList.remove('hidden');
            successPage.classList.add('fade-in');
            
            startFloatingAnimation();
            triggerConfetti();
        }

        function triggerConfetti() {
            const duration = 3000;
            const animationEnd = Date.now() + duration;
            const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 0 };
            const random = (min, max) => Math.random() * (max - min) + min;

            const interval = setInterval(function() {
                const timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                const particleCount = 50 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.1, 0.3), y: Math.random() - 0.2 } }));
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: random(0.7, 0.9), y: Math.random() - 0.2 } }));
            }, 250);
        }

        function startFloatingAnimation() {
            setInterval(() => {
                const elements = ['‚ù§Ô∏è', 'üéà', 'üéÄ', 'üåπ', 'üòª'];
                const element = document.createElement('div');
                element.innerText = elements[Math.floor(Math.random() * elements.length)];
                element.classList.add('floating-item');
                element.style.left = Math.random() * 100 + 'vw';
                element.style.animationDuration = (Math.random() * 3 + 3) + 's';
                element.style.fontSize = (Math.random() * 20 + 20) + 'px';
                document.body.appendChild(element);
                setTimeout(() => element.remove(), 6000);
            }, 300);
        }
    </script>
</body>
</html>

